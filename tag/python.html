<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hannah Clare Wray Hazi | articles tagged "python"</title>
    <link rel="shortcut icon" type="image/png" href="../favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
    <link rel="stylesheet" href="../theme/css/screen.css" type="text/css" />
    <link rel="stylesheet" href="../theme/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../theme/css/print.css" type="text/css" media="print" />
    <meta name="generator" content="Pelican" />
    <meta name="description" content="" />
    <meta name="author" content="Hannah Hazi" />
</head>
<body>
    <header>
        <nav>
            <ul>
                <li class="ephemeral selected"><a href="../tag/python.html">python</a></li>
                <li><a href="../">Home</a></li>
                <li><a href="../pages/about.html">About Me</a></li>
                <li><a href="https://github.com/raspberrycheesecake">GitHub</a></li>
                <li><a href="mailto:hannah.hazi@cantab.net">Contact Me</a></li>
                <li><a href="https://uk.linkedin.com/in/hannah-hazi-9b985a84">LinkedIn</a></li>
                <li><a href="../archives">Archives</a></li>
            </ul>
        </nav>
        <div class="header_box">
            <h1><a href="../">Hannah Clare Wray Hazi</a></h1>
            <h2>I love making beautiful things.</h2>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">            <h4 class="date">Oct 30, 2017</h4>

            <article class="post">
                <h2 class="title">
                    <a href="../pycon-uk-2017.html" rel="bookmark" title="Permanent Link to &quot;PyCon UK 2017!&quot;">PyCon UK 2017!</a>
                </h2>

                
                

                <p>I spent the last few days at <a href="http://2017.pyconuk.org/">PyCon UK</a>, and thought I'd write a post about my experiences there. It was my first time at the conference and I thoroughly enjoyed it, as you can probably tell from the liberal number of exclamation marks scattered through this post.</p>
<h1>I gave a talk!</h1>
<p>On the first day of the conference I spoke about <a href="https://2017.pyconuk.org/sessions/talks/python-as-a-second-language">Python As a Second Language</a>. The organisers put me in the Biggest Room so I had to fight off some pre-talk nerves,
but I was glad to have the chance to do it and got some lovely feedback afterwards. Thanks again to <a href="https://github.com/emmagordon/">Emma Gordon</a> for encouraging me to give it a go and push my comfort zone! Doing a talk on Thursday also meant I was free to enjoy the rest of the conference without worrying, which I definitely recommend.</p>
<p>For those who are interested, a video of my talk will soon be up on YouTube - stay tuned!</p>
<h1>I went to talks and workshops!</h1>
<p>The conference was full of great talks and sessions, so this is just a small sampling of what I particularly remember enjoying. Of course, I'd like to give a shout-out to my colleagues Emma Gordon and Jan Chwiejczak who respectively gave the very silly and fun <a href="https://github.com/emmagordon/python-bee]">Python Spelling Bee</a>, and a (very oversubscribed) workshop on <a href="http://2017.pyconuk.org/sessions/workshops/toying-with-python-bytecode-hands-on-session/">Python Bytecode</a> &amp; lavishly illustrated talk on <a href="http://2017.pyconuk.org/sessions/talks/the-art-of-testing-in-python/">the Art of Testing</a>.</p>
<ul>
<li>
<p><strong>Unsafe At Any Speed</strong> Rae Knowler made some great points about dangerous library defaults, illustrated with scary examples from the wild. I'll be sure to use <code>PyYAML.safe_load()</code> rather than <code>load()</code> from now on...!</p>
</li>
<li>
<p><strong>Shaping the World</strong> David McIver's keyote was thought-provoking and fascinating, not just about software, but ethics, history and human interactions - the sort of thing <a href="https://onfoodandcoding.blogspot.co.uk">Stuart Wray</a> would probably enjoy.</p>
</li>
<li>
<p><strong>Docs or it didn't happen!</strong> I was encouraged to join the Documentarian Club by Mikey Ariel, who gave an inspiring talk about why good documentation is so important.</p>
</li>
<li>
<p><strong>Software's Seven Deadly Wastes</strong> Jez applied the Toyota Production System's 'Seven Wastes' concept to software engineering beautifully - pleasing my manufacturing engineering heart and giving me some food for thought.</p>
</li>
<li>
<p><strong>Circumnavigating the Antarctic with Python and Django</strong> A fascinating talk that cast a light on the challenge developing with no (or a very patchy) Internet connection. What, no googling for StackOverflow posts?! Carles and Jen managed data for 22 scientists on a trip circumnavigating the Antarctic, and built them some useful tools as well like an intranet 'Facebook' and web portal to enter their latest data.</p>
</li>
<li>
<p><strong>The micro:bit talks</strong> I discovered from the team at the micro:bit foundation how the BBC micro:bit is being used by teachers and for STEM outreach. It's a great project and it sounds like it's already having a lot of success getting kids into learning to code in an accessible way.</p>
</li>
<li>
<p><strong>Choo choo! All aboard the Data Train!</strong> It turns out there is a lot of open data available from TfL and National Rail about train movements in the UK. The talk went by quickly but I'll definitely be rewatching to get inspiration for my next project!</p>
</li>
<li>
<p><strong>Lightning Talks</strong> One of the highlights of the conference was the range of lightning talks at the end of each day. Among much else they gave me a great brownie recipe, book recommendations and a moment of meditation calm. A particular favourite was the children's lightning talks - they were so confident speaking about their projects, it was lovely to hear.</p>
</li>
</ul>
<p>The nice thing about PyCon UK is that they <a href="https://www.youtube.com/channel/UChA9XP_feY1-1oSy2L7acog">video all of the talks in the Assembly Room</a>, so I'll be able to go back and watch the ones I missed over the next few weeks, and learn more from the ones I went to.</p>
<p>I didn't take part in many workshops as I was busy manning the CMR stall (we were one of the sponsors so were giving away some free trinkets). I did really enjoy <a href="https://alexwlchan.net/2017/10/pyconuk-2017-resources/">Alex Chan's</a> <strong>A Plumber's Guide To Git</strong> workshop - I think it really helped unpack the inner workings of Git for me. At the end I started to understand what's going on 'under the hood' when I <code>git add</code> and <code>git commit</code> and it's really neat.</p>
<h1>I got swag!</h1>
<p><img alt="schwag" src="../images/socks-swag.jpg"></p>
<p>As well as this snazzy pair of Python socks as a thank-you for giving a talk, I also picked up a free <a href="http://microbit.org">BBC micro:bit</a> delightfully packaged in a sweetie-bag and enjoyed playing with it. For such a small bit of kit is has a surprising range of functions, including an accelerometer, 25 LEDs with variable brightness, two buttons and some I/O. I look forward to using it for embedded projects!</p>
<h1>I met new people!</h1>
<p>One of the best things about PyCon was a chance to meet people using Python from around the UK (and further afield). It was inspiring to see how the language is being used by all sorts of folks. Everyone was friendly and welcoming, and it was a great place to give a talk. I also got the chance to spend more time getting to know people I already was acquainted with from <a href="https://www.meetup.com/CamPUG">CamPUG</a>, the Cambridge Python Users Group, and had some really interesting discussions. </p>
<p>If anyone is thinking of going but isn't sure if it's for them, I'd really reccomend giving PyCon UK a try - the environment is relaxed and friendly, and the organisers try hard to make everyone feel welcome and included. I'll definitely be coming back next year!</p>
                <div class="clear"></div>

                <div class="info">
                    <a href="../pycon-uk-2017.html">posted at 00:00</a>
                    &nbsp;&middot;
                    &nbsp;<a href="../tag/conference.html" class="tags">conference</a>
                    &nbsp;<a href="../tag/python.html" class="tags selected">python</a>
                    &nbsp;<a href="../tag/cardiff.html" class="tags">Cardiff</a>
                </div>
		<a href="../pycon-uk-2017.html#disqus_thread">Click to read and post comments</a>
            </article>            <h4 class="date">Oct 12, 2017</h4>

            <article class="post">
                <h2 class="title">
                    <a href="../value-of-legacy-code.html" rel="bookmark" title="Permanent Link to &quot;The Knowledge in the Code&quot;">The Knowledge in the Code</a>
                </h2>

                
                

                <p>My colleagues and I were discussing legacy code the other day. Someone gave the pretty common opinion that, if there was time, they would of course completely re-write all the legacy code they came across, from scratch. But, since this is not an ideal world and time is limited, they would settle for refactoring what they could.</p>
<p>The classic legacy code situation is one I have been in on a summer project while at university. A scientist wrote a large piece of Fortran 95 to simulate a manufacturing process for a company. He had long since retired and there was no way to contact him to ask about his work. Now the company brought me in as an intern and asked me to add some extra functionality. They were still using the code and found it reliable, but wanted to add a feature for their new equipment. The code stood alone as an explanation of itself, and I had to try to interpret it. I felt like an archaeologist, dusting off terse variable names and cryptic comments, trying to understand not only this code but the complex processes it was simulating, too.</p>
<p><img alt="Indiana Jones and the Lost Code" src=""></p>
<p>I had the attitude that I think most programmers would - rewrite it! Tear it down completely and rebuild it, preferrably in a different, more modern language. Then, you can add the features that you need. But my manager was adamantly against this. As a summer intern, I would leave soon anyway. If I rewrote the code in another language, where was the benefit to the company? From their perspective, they already had a tool that worked fine. They just needed someone who could understand what they already had and improve it a bit. At the time I was frustrated by this, and would tell others the anecdote with a wistful air - "If only I had had the time to rewrite it properly" I would think, "it would have been so much better". But <strong>would</strong> it have?</p>
<h1>Why Rewrite Code?</h1>
<p>I've come across a few different reasons for re-writing code completely.</p>
<ul>
<li>
<p>To write it in a new language. The new language is considered to be 'better' - it has features you want, or the old language is considered passe.</p>
</li>
<li>
<p>For understanding. No-one can figure out how the old code works, so let's learn by doing and rewrite it. It's certainly "<em>easier to write code than read it."</em> This is even true of one's own code - returning to something I coded six months ago, I realised to my regret I left insufficient comments and good names behind - so I had to learn how to understand my own code again!</p>
</li>
<li>
<p>You don't trust the people who wrote the code. 'Not Invented Here' syndrome.</p>
</li>
<li>
<p>The real one, the deep-down felt one: the old code looks <em>bad</em> - it's flaky, it doesn't have any test coverage, the relationship between the parts is crazy. When you read it, you have this instinct to laugh out loud - it's a big hot mess.</p>
</li>
</ul>
<h1>Why Keep Code?</h1>
<p>Joel Spolsky of <a href="https://www.joelonsoftware.com/2000/04/06/things-you-should-never-do-part-i/">Joel on Software</a> fame has called rewriting source code from scratch "the single worst strategic mistake that any software company can make". He uses the example of Mozilla. As a corporate strategy, complete re-writes are almost never a good idea. They tend to take longer than anticipated, and burn time and resources for no appreciable reward until the very end when the new code is ready - by which time, a competitor has probably caught up to you and eaten your lunch.</p>
<p><a href="http://wiki.c2.com/?CodeLearns">Code Learns.</a> </p>
<p>As Joel points out, 'hairy' legacy code functions embody years of bug fixes and reactions to specific situations.</p>
<p>But not only that. Legacy code often embodies knowledge about a process, knowledge that is very difficult to retrieve any other way.</p>
<p>Adding tests and incrementally refactoring old code can give excellent results, in less time than a complete rewrite. <a href="">Your Code as a Crime Scene</a> explains that making improvements to the code can and should be done in a <em>targeted</em> way, rather than by hunches - focusing on areas with the highest cyclomatic complexity and churn.</p>
<h1>A Book Recommendation</h1>
<p>In the course of my research for this post I came across <a href="https://www.spinellis.gr/codereading/">Code Reading</a>, a book about precisely the discipline reading legacy code in order to maintain it and add features. This looks to be a great primer on a neglected skill for programmers. I plan to read it myself and leave a review here, soon.</p>
                <div class="clear"></div>

                <div class="info">
                    <a href="../value-of-legacy-code.html">posted at 00:00</a>
                    &nbsp;&middot;&nbsp;<a href="../category/code-musings.html" rel="tag">code-musings</a>
                    &nbsp;&middot;
                    &nbsp;<a href="../tag/python.html" class="tags">Python</a>
                    &nbsp;<a href="../tag/codebase.html" class="tags">codebase</a>
                    &nbsp;<a href="../tag/legacy-code.html" class="tags">legacy code</a>
                    &nbsp;<a href="../tag/refactoring.html" class="tags">refactoring</a>
                </div>
		<a href="../value-of-legacy-code.html#disqus_thread">Click to read and post comments</a>
            </article>            <h4 class="date">Feb 13, 2017</h4>

            <article class="post">
                <h2 class="title">
                    <a href="../monkey-patching.html" rel="bookmark" title="Permanent Link to &quot;Monkey Patching Reprise&quot;">Monkey Patching Reprise</a>
                </h2>

                
                

                <p>It turns out that things aren't as simple as they seemed in my last post. A couple of people have pointed out to me that Python can indeed do monkey patching - so what's the difference between this and Ruby? Am I just making a fuss over nothing? First of all, to some proper definitions.</p>
<h1>What Even Is Monkey Patching?</h1>
<p>It's also known as guerilla (/gorilla) patching, hot-fixing, and more recently, 'duck-punching'.</p>
<blockquote>
<p><strong>Geoffrey</strong>: Now, you went to PyCon a couple months ago. And it’s well-known that in the Python world, they frown on monkey-patching. Do you think they would think more positively of duck-punching?</p>
<p><strong>Adam</strong>: No, I think they will continue to look down on us, no matter how awesome and hilarious we become.</p>
<p><strong>Voice In Background</strong>: Isn’t that the truth.</p>
<p><strong>Geoffrey</strong>: I also have Patrick Ewing. Is this a good idea, and will it catch on?</p>
<p><strong>Patrick Ewing</strong>: Well, I was just totally sold by Adam, the idea being that if it walks like a duck and talks like a duck, it’s a duck, right? So if this duck is not giving you the noise that you want, you’ve got to just punch that duck until it returns what you expect.</p>
<p><a href="https://web.archive.org/web/20120114085702/http://podcast.rubyonrails.org/programs/1/episodes/railsconf-2007">Transcript from Geoffrey Grosenbach podcast</a> at RailsConf2007</p>
</blockquote>
<p>Monkey patching can mean some subtly different things:</p>
<ul>
<li>Changing a class's methods at runtime</li>
<li>Changing a class's methods at runtime <em>and making all the instances of that class change after the fact</em></li>
</ul>
<p>As pointed out in <a href="http://stackoverflow.com/questions/192649/can-you-monkey-patch-methods-on-core-types-in-python">this thread on StackOverFlow</a> by Dan Lenski, both variants are indeed possible with Python. Here's an example:</p>
<div class="highlight"><pre><span class="k">class</span> <span class="n">Widget:</span>
    <span class="n">def</span> <span class="n">__init__</span>(<span class="k">self</span>):
       <span class="nb">pass</span>
    <span class="n">def</span> <span class="n">who_am_i</span>(<span class="k">self</span>):
       <span class="nb">print</span>(<span class="s">&quot;I&#39;m a widget&quot;</span>)

&gt;&gt;&gt; <span class="n">my_widget</span> = <span class="n">Widget</span>()
&gt;&gt;&gt; <span class="n">my_widget</span>
<span class="s">&lt;Widget object at 0x7f6b5aa52e80&gt;</span>
&gt;&gt;&gt; <span class="n">my_widget</span>.<span class="n">who_am_i</span>()
<span class="n">I&#39;m</span> <span class="n">a</span> <span class="n">widget</span>
&gt;&gt;&gt; <span class="n">def</span> <span class="n">teapot</span>(<span class="k">self</span>):
...     <span class="nb">print</span>(<span class="s">&quot;I&#39;m a little teapot&quot;</span>)
...
&gt;&gt;&gt; <span class="n">Widget</span>.<span class="n">who_am_i</span> = <span class="n">teapot</span>
&gt;&gt;&gt; <span class="n">my_widget</span>.<span class="n">who_am_i</span>()
<span class="n">I&#39;m</span> <span class="n">a</span> <span class="n">little</span> <span class="n">teapot</span>
&gt;&gt;&gt; <span class="n">new_widget</span> = <span class="n">Widget</span>()
&gt;&gt;&gt; <span class="n">new_widget</span>.<span class="n">who_am_i</span>()
<span class="n">I&#39;m</span> <span class="n">a</span> <span class="n">little</span> <span class="n">teapot</span>
</pre></div>


<p>And Python doesn't warn you either! So perhaps I was unfairly harsh to Ruby? Not quite.</p>
<h1>One <em>Important</em> Difference</h1>
<p><em>Unlike</em> with Ruby, we can't monkeypatch the basic built-in classes, such as <code>int</code>, <code>float</code> or <code>str</code>. This is because they are defined in C extension modules which are immutable. These modules are shared between multiple interpreters and made immutable for efficiency (and safety)'s sake. So when you try to change the behaviour of the built-ins, you can't -</p>
<div class="highlight"><pre>def own_up(self, a_string):
    return a_string.length()*&quot;!&quot;

&gt;&gt;&gt;my_string = &quot;Hello, World!&quot;
&gt;&gt;&gt; my_string.upper()
&#39;HELLO, WORLD!&#39;
&gt;&gt;&gt; str.upper = own_up
Traceback (most recent call last):
  File &quot;&lt;input&gt;&quot;, line 1, in &lt;module&gt;
TypeError: can&#39;t set attributes of built-in/extension type &#39;str&#39;
</pre></div>


<p>To do something which approximates the effects of monkeypatching a built-in we have to subclass, like so - this example lets us write a custom instance of the str.upper() method by inheriting from str.</p>
<div class="highlight"><pre><span class="k">class</span> <span class="n">CustomString</span>(<span class="n">str</span>):
    <span class="n">def</span> <span class="n">upper</span>(<span class="k">self</span>):
        <span class="n">desired_value</span> = <span class="s">&quot;!&quot;</span> * <span class="n">len</span>(<span class="k">self</span>)
        <span class="k">return</span> <span class="n">CustomString</span>(<span class="n">desired_value</span>)

&gt;&gt;&gt; <span class="n">custom</span> = <span class="n">CustomString</span>(<span class="s">&quot;hello world&quot;</span>)
&gt;&gt;&gt; <span class="n">custom</span>
<span class="s">&#39;hello world&#39;</span>
&gt;&gt;&gt; <span class="n">custom</span>.<span class="n">upper</span>()
<span class="s">&#39;!!!!!!!!!!!&#39;</span>
</pre></div>


<p>Ta-da! I still maintain that this is saner behaviour than Ruby.</p>
<p>(Sidenote - Remember, for str and any class based on it, Python strings are immutable - when we call methods on a string, we just get a new return value that we have to assign to some other string object to store.)</p>
<h1>If Python and Ruby do it in similar ways, is Monkey Patching even All That Bad, then?</h1>
<p>Yes! I still maintain that monkey patching is dangerous and shouldn't be used often. I think it says something positive about Python that it's not something you need to know intimately in order to program competently in the language, and indeed most Python programmers I know feel a bit iffy about it. It's a little off-putting (to say the least) to realise how much of a way of life it is for Ruby programmers.</p>
<p>But don't just take my word for it - have a read of this <a href="http://www.virtuouscode.com/2008/02/23/why-monkeypatching-is-destroying-ruby/">insightful blog post</a> by Avdi Grimm, an experienced Rubyist worried about the impact of thoughtless 'hip' monkey patching - a choice quote:</p>
<blockquote>
<p>Where I work, we are already seeing subtle, difficult-to-debug problems crop up as the result of monkey patching in plugins.  Patches interact in unpredictable, combinatoric ways.  And by their nature, bugs caused by monkey patches  are more difficult to track down than those introduced by more traditional classes and methods.  As just one example: on one project, it was a known caveat that we could not rely on class inheritable attributes as provided by ActiveSupport.  No one knew why.</p>
</blockquote>
<p>A fun (scary) read.</p>
<h1>Temporary Monkey Patching in Python for testing</h1>
<p>As I was looking around at this stuff, I discovered there are a couple of libraries, <a href="https://docs.python.org/3/library/unittest.mock.html#patch"><code>unittest.mock.patch</code></a> and <a href="http://docs.pytest.org/en/latest/monkeypatch.html"><code>pytest monkeypatch</code></a> designed to allow <em>temporary</em> monkeypatching for testing - when the function or statement using it exits, the patch disappears. I can see how useful it would be to set up mocks in this controlled way, rather than having to worry about it affecting all of your tests. It was deemed so handy that <code>mock</code> is now part of the standard library in Python3. Time to investigate further!</p>
                <div class="clear"></div>

                <div class="info">
                    <a href="../monkey-patching.html">posted at 00:00</a>
                    &nbsp;&middot;
                    &nbsp;<a href="../tag/ruby.html" class="tags">Ruby</a>
                    &nbsp;<a href="../tag/python.html" class="tags">Python</a>
                </div>
		<a href="../monkey-patching.html#disqus_thread">Click to read and post comments</a>
            </article>            <h4 class="date">Jan 23, 2017</h4>

            <article class="post">
                <h2 class="title">
                    <a href="../stop-writing-classes.html" rel="bookmark" title="Permanent Link to &quot;Stop Writing (Unecessary) Classes&quot;">Stop Writing (Unecessary) Classes</a>
                </h2>

                
                

                <p>I listened to a great talk recently called <a href="https://www.youtube.com/embed/o9pEzgHorH0?feature=player_embedded&amp;iv_load_policy=3&amp;autoplay=1&amp;rel=0&amp;start=20">Stop Using Classes</a> by Peter Diedrich. The talk goes through some of the unhelpful ways classes can be used in Python and makes good points about readability and simplicity. Here's my mindmap of the talk.
<img alt="My mindmap of the talk" src="../images/stop_using_classes.jpg"> </p>
<h2>Game of Life</h2>
<p>Diedrich uses as an example a neat implementation of Conway's <a href="https://en.wikipedia.org/wiki/Conway's_Game_of_Life">Game of Life</a> which is beautifully straightforward and avoids the tempting trap of making a class for a Cell, a class for a Board, etc. His example is so small I've copied and annotated it here (renamed a few of the variables for extra clarity):</p>
<div class="highlight"><pre><span class="sd">&quot;&quot;&quot; Example Game of Life from &#39;Stop Writing Classes&#39; talk by Jack Diedrich. &quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">itertools</span>


<span class="k">def</span> <span class="nf">neighbours</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">point</span>
    <span class="k">yield</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">yield</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span>
    <span class="k">yield</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">yield</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">yield</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">yield</span> <span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">yield</span> <span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span>
    <span class="k">yield</span> <span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="mi">1</span>


<span class="k">def</span> <span class="nf">advance</span><span class="p">(</span><span class="n">board</span><span class="p">):</span>
    <span class="n">new_state</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>  <span class="c1"># initialises a set with a blank list inside</span>
    <span class="n">friends</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">neighbours</span><span class="p">,</span> <span class="n">board</span><span class="p">)))</span>
    <span class="n">cells_we_care_about</span> <span class="o">=</span> <span class="n">board</span> <span class="o">|</span> <span class="n">friends</span>

    <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">cells_we_care_about</span><span class="p">:</span>
        <span class="n">count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">cell</span> <span class="ow">in</span> <span class="n">board</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">neighbours</span><span class="p">(</span><span class="n">point</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">or</span> <span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">board</span><span class="p">):</span>
            <span class="n">new_state</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">new_state</span>


<span class="n">glider</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">glider</span> <span class="o">=</span> <span class="n">advance</span><span class="p">(</span><span class="n">glider</span><span class="p">)</span>

<span class="k">print</span> <span class="n">glider</span>
</pre></div>


<p>What <code>friends</code> does requires some unpacking. First of all, <code>*map(neighbours, board)</code> takes the iterable returned from <code>map(neighbours, board)</code> and returns it. The <code>*</code> is a useful way to split up the returned single thing from <code>map</code> into each piece and feed them separately to the <code>chain()</code> function as arguments. Here's an example of <code>*</code> in action:</p>
<div class="highlight"><pre>def hallo(arg1, arg2):
     print(arg1)
     print(arg2)
     print(&quot;Hallo!!&quot;)

&gt;&gt;&gt; printme = (&quot;Yes&quot;, &quot;Indeed&quot;)
&gt;&gt;&gt; hallo(printme)
Traceback (most recent call last):
  File &quot;/usr/lib/python3.5/code.py&quot;, line 91, in runcode
    exec(code, self.locals)
  File &quot;&lt;input&gt;&quot;, line 1, in &lt;module&gt;
TypeError: hallo() missing 1 required positional argument: &#39;arg2&#39;
&gt;&gt;&gt; hallo(*printme)
Yes
Indeed
Hallo!!
</pre></div>


<p>This <code>map()</code> iterable is the function <code>neighbours()</code> applied to every point in <code>board</code>. So <code>map(neighbours, board)</code> returns sets of all the live cells' neighbours. This is used as an argument to the <code>chain()</code> function. What <code>chain()</code> does is glues groups of iterable things together into a <code>chain</code> object. For example:</p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">itertools</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">love</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">,</span> <span class="s2">&quot;DEF&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">love</span>
<span class="o">&lt;</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7fe58ada5810</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">love</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">print</span> <span class="n">item</span>
<span class="o">...</span>     
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="n">D</span>
<span class="n">E</span>
<span class="n">F</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sling_it_into_a_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">love</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">sling_it_into_a_set</span>
<span class="nb">set</span><span class="p">([</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>


<p>So it bungs all the sets of neighbours into one single set. Because of how Python sets work, this gets rid of any duplicate points - eg points which neighbour a couple of living cells should still only be mentioned once.</p>
<p><code>|</code> is just Python's binary OR operator - so <code>cells_we_care_about</code> is a set which contains all points that are in the list of live cells OR the list of their neighbours</p>
<p><code>count</code> counts neighbours for each living and dead cell. Diedrich then applies the rules for Conway's Game of Life in one line: 
<em> A dead cell that has 3 live neighbours becomes alive
</em> A live cell that has 2 live neighbours remains alive
* Every other cell dies.</p>
<h2>Sets are awesome</h2>
<p>One of the reasons his implementation is so tidy and has so few lines is his great use of <code>set()</code>, one of the built-in Python types. Sets are particularly great for this problem because they contain only unique elements - if you try to add multiples of the same element to a set you only end up with one in there. This means any duplicate points are eliminated without having to think about it. </p>
<p>For more examples of how to get good use out of Python's built-ins I recommend <a href="https://www.youtube.com/watch?v=lyDLAutA88s">Built in Super Heroes</a> by the excellent Dave Beazley. </p>
                <div class="clear"></div>

                <div class="info">
                    <a href="../stop-writing-classes.html">posted at 00:00</a>
                    &nbsp;&middot;&nbsp;<a href="../category/python.html" rel="tag">python</a>
                    &nbsp;&middot;
                    &nbsp;<a href="../tag/python.html" class="tags selected">python</a>
                    &nbsp;<a href="../tag/classes.html" class="tags">classes</a>
                    &nbsp;<a href="../tag/talks.html" class="tags">talks</a>
                </div>
		<a href="../stop-writing-classes.html#disqus_thread">Click to read and post comments</a>
            </article>

            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/jody-frankowski/blue-penguin">Blue Penguin</a> Theme
                &middot;
                Proudly Powered by <a href="http://getpelican.com">Pelican</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
</body>
</html>